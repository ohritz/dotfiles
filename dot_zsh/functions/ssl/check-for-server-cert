# SSL function: Check server certificate
# Dependencies: openssl, spinner
# Purpose: Check SSL certificate for server connection
# Usage: check-for-server-cert <address> [port]

check-for-server-cert() {
    local tempout=$(mktemp)
    trap "rm -f $tempout" EXIT
    local address=${1:?"Missing address mate"}
    local port=${2:-443}
    echo "running openssl s_client for address: $address and port: $port"
    (openssl s_client -showcerts -servername $address -connect $address:$port </dev/null) >$tempout 2>&1 &
    spinner $!
    local output=$(cat $tempout)
    echo $output
}
